<!-- Inventory Management Page -->
<div class="inventory-page">
    <div class="page-header">
        <h1 class="page-title">إدارة المخزون</h1>
        <div class="page-actions">
            <button class="btn btn-primary" id="add-item-btn">
                <span class="btn-icon">➕</span>
                إضافة صنف
            </button>
            <button class="btn btn-secondary" id="import-excel-btn">
                <span class="btn-icon">📥</span>
                استيراد من Excel
            </button>
            <button class="btn btn-secondary" id="export-excel-btn">
                <span class="btn-icon">📤</span>
                تصدير إلى Excel
            </button>
            <button class="btn btn-secondary" id="generate-barcode-btn">
                <span class="btn-icon">🏷️</span>
                توليد باركود
            </button>
        </div>
    </div>

    <!-- Search and Filter Section -->
    <div class="search-filter-section">
        <div class="search-box">
            <input type="text" id="inventory-search" placeholder="البحث في المخزون..." class="form-control">
            <button class="search-btn" id="search-btn">
                <span class="search-icon">🔍</span>
            </button>
        </div>
        
        <div class="filter-controls">
            <select id="category-filter" class="form-control">
                <option value="">جميع الفئات</option>
            </select>
            
            <select id="brand-filter" class="form-control">
                <option value="">جميع الماركات</option>
            </select>
            
            <select id="stock-filter" class="form-control">
                <option value="">جميع الأصناف</option>
                <option value="low">مخزون منخفض</option>
                <option value="out">نفد المخزون</option>
                <option value="normal">مخزون طبيعي</option>
            </select>
            
            <button class="btn btn-outline" id="clear-filters-btn">
                <span class="btn-icon">🗑️</span>
                مسح الفلاتر
            </button>
        </div>
    </div>

    <!-- Inventory Statistics -->
    <div class="inventory-stats">
        <div class="stat-card">
            <div class="stat-icon">📦</div>
            <div class="stat-content">
                <div class="stat-value" id="total-items-count">0</div>
                <div class="stat-label">إجمالي الأصناف</div>
            </div>
        </div>
        <div class="stat-card">
            <div class="stat-icon">💰</div>
            <div class="stat-content">
                <div class="stat-value" id="total-value">0</div>
                <div class="stat-label">إجمالي القيمة</div>
            </div>
        </div>
        <div class="stat-card">
            <div class="stat-icon">⚠️</div>
            <div class="stat-content">
                <div class="stat-value" id="low-stock-count">0</div>
                <div class="stat-label">مخزون منخفض</div>
            </div>
        </div>
        <div class="stat-card">
            <div class="stat-icon">❌</div>
            <div class="stat-content">
                <div class="stat-value" id="out-of-stock-count">0</div>
                <div class="stat-label">نفد المخزون</div>
            </div>
        </div>
    </div>

    <!-- Inventory Table -->
    <div class="table-container">
        <table class="data-table" id="inventory-table">
            <thead>
                <tr>
                    <th class="sortable" data-sort="name">اسم المنتج</th>
                    <th class="sortable" data-sort="barcode">الباركود</th>
                    <th class="sortable" data-sort="category">الفئة</th>
                    <th class="sortable" data-sort="brand">الماركة</th>
                    <th class="sortable" data-sort="unit_price">السعر</th>
                    <th class="sortable" data-sort="stock_quantity">الكمية</th>
                    <th class="sortable" data-sort="min_stock_level">الحد الأدنى</th>
                    <th>الحالة</th>
                    <th>الإجراءات</th>
                </tr>
            </thead>
            <tbody id="inventory-tbody">
                <!-- Dynamic content will be loaded here -->
            </tbody>
        </table>
    </div>

    <!-- Pagination -->
    <div class="pagination-container">
        <div class="pagination-info">
            <span id="pagination-info">عرض 1-10 من 100 عنصر</span>
        </div>
        <div class="pagination-controls">
            <button class="btn btn-outline" id="prev-page-btn" disabled>
                <span class="btn-icon">←</span>
                السابق
            </button>
            <div class="page-numbers" id="page-numbers">
                <!-- Dynamic page numbers will be loaded here -->
            </div>
            <button class="btn btn-outline" id="next-page-btn">
                التالي
                <span class="btn-icon">→</span>
            </button>
        </div>
    </div>
</div>

<!-- Add/Edit Item Modal -->
<div id="item-modal" class="modal-overlay" style="display: none;">
    <div class="modal large-modal">
        <div class="modal-header">
            <h3 class="modal-title" id="item-modal-title">إضافة صنف جديد</h3>
            <button class="modal-close" id="item-modal-close">&times;</button>
        </div>
        <div class="modal-body">
            <form id="item-form" class="item-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="item-name" class="form-label">اسم المنتج *</label>
                        <input type="text" id="item-name" name="name" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="item-name-en" class="form-label">اسم المنتج بالانجليزي</label>
                        <input type="text" id="item-name-en" name="name_en" class="form-control">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="item-barcode" class="form-label">الباركود</label>
                        <input type="text" id="item-barcode" name="barcode" class="form-control">
                        <button type="button" class="btn btn-small" id="generate-barcode-btn-modal">توليد</button>
                    </div>
                    <div class="form-group">
                        <label for="item-sku" class="form-label">كود المنتج</label>
                        <input type="text" id="item-sku" name="sku" class="form-control">
                    </div>
                </div>

                <div class="form-group">
                    <label for="item-description" class="form-label">الوصف</label>
                    <textarea id="item-description" name="description" class="form-control" rows="3"></textarea>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="item-category" class="form-label">الفئة *</label>
                        <select id="item-category" name="category_id" class="form-control" required>
                            <option value="">اختر الفئة</option>
                        </select>
                        <button type="button" class="btn btn-small" id="add-category-btn">إضافة فئة</button>
                    </div>
                    <div class="form-group">
                        <label for="item-brand" class="form-label">الماركة *</label>
                        <select id="item-brand" name="brand_id" class="form-control" required>
                            <option value="">اختر الماركة</option>
                        </select>
                        <button type="button" class="btn btn-small" id="add-brand-btn">إضافة ماركة</button>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="item-unit-price" class="form-label">سعر البيع *</label>
                        <input type="number" id="item-unit-price" name="unit_price" class="form-control" step="0.01" min="0" required>
                    </div>
                    <div class="form-group">
                        <label for="item-cost-price" class="form-label">سعر التكلفة</label>
                        <input type="number" id="item-cost-price" name="cost_price" class="form-control" step="0.01" min="0">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="item-stock-quantity" class="form-label">الكمية الحالية *</label>
                        <input type="number" id="item-stock-quantity" name="stock_quantity" class="form-control" min="0" required>
                    </div>
                    <div class="form-group">
                        <label for="item-unit" class="form-label">الوحدة</label>
                        <select id="item-unit" name="unit" class="form-control">
                            <option value="قطعة">قطعة</option>
                            <option value="كيلو">كيلو</option>
                            <option value="لتر">لتر</option>
                            <option value="متر">متر</option>
                            <option value="صندوق">صندوق</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="item-min-stock" class="form-label">الحد الأدنى</label>
                        <input type="number" id="item-min-stock" name="min_stock_level" class="form-control" min="0">
                    </div>
                    <div class="form-group">
                        <label for="item-max-stock" class="form-label">الحد الأقصى</label>
                        <input type="number" id="item-max-stock" name="max_stock_level" class="form-control" min="0">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="item-car-brand" class="form-label">ماركة السيارة</label>
                        <input type="text" id="item-car-brand" name="car_brand" class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="item-car-model" class="form-label">موديل السيارة</label>
                        <input type="text" id="item-car-model" name="car_model" class="form-control">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="item-part-number" class="form-label">رقم القطعة</label>
                        <input type="text" id="item-part-number" name="part_number" class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="item-oem-number" class="form-label">رقم OEM</label>
                        <input type="text" id="item-oem-number" name="oem_number" class="form-control">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="item-weight" class="form-label">الوزن (كيلو)</label>
                        <input type="number" id="item-weight" name="weight" class="form-control" step="0.01" min="0">
                    </div>
                    <div class="form-group">
                        <label for="item-warranty" class="form-label">فترة الضمان (شهر)</label>
                        <input type="number" id="item-warranty" name="warranty_period" class="form-control" min="0">
                    </div>
                </div>

                <div class="form-group">
                    <label for="item-supplier" class="form-label">المورد</label>
                    <select id="item-supplier" name="supplier_id" class="form-control">
                        <option value="">اختر المورد</option>
                    </select>
                </div>
            </form>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-secondary" id="item-modal-cancel">إلغاء</button>
            <button type="button" class="btn btn-primary" id="item-modal-save">حفظ</button>
        </div>
    </div>
</div>

<!-- Import Excel Modal -->
<div id="import-modal" class="modal-overlay" style="display: none;">
    <div class="modal large-modal">
        <div class="modal-header">
            <h3 class="modal-title">استيراد المخزون من Excel</h3>
            <button class="modal-close" id="import-modal-close">&times;</button>
        </div>
        <div class="modal-body">
            <div class="import-steps">
                <div class="step active" data-step="1">
                    <div class="step-number">1</div>
                    <div class="step-title">اختيار الملف</div>
                </div>
                <div class="step" data-step="2">
                    <div class="step-number">2</div>
                    <div class="step-title">مراجعة البيانات</div>
                </div>
                <div class="step" data-step="3">
                    <div class="step-number">3</div>
                    <div class="step-title">الاستيراد</div>
                </div>
            </div>

            <div class="step-content" id="step-1">
                <div class="file-upload-area" id="file-upload-area">
                    <div class="upload-icon">📁</div>
                    <h4>اسحب الملف هنا أو اضغط للاختيار</h4>
                    <p>يدعم الملفات: Excel (.xlsx, .xls) و CSV</p>
                    <button class="btn btn-primary" id="select-file-btn">اختيار ملف</button>
                </div>
                
                <div class="template-section">
                    <h4>تحميل قالب Excel</h4>
                    <p>استخدم هذا القالب لتنظيم بياناتك بشكل صحيح</p>
                    <button class="btn btn-secondary" id="download-template-btn">تحميل القالب</button>
                </div>
            </div>

            <div class="step-content" id="step-2" style="display: none;">
                <div class="validation-results" id="validation-results">
                    <!-- Validation results will be shown here -->
                </div>
            </div>

            <div class="step-content" id="step-3" style="display: none;">
                <div class="import-progress">
                    <div class="progress-bar">
                        <div class="progress-fill" id="import-progress-fill"></div>
                    </div>
                    <div class="progress-text" id="import-progress-text">جاري الاستيراد...</div>
                </div>
                
                <div class="import-results" id="import-results" style="display: none;">
                    <!-- Import results will be shown here -->
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-secondary" id="import-modal-cancel">إلغاء</button>
            <button type="button" class="btn btn-primary" id="import-modal-next" disabled>التالي</button>
            <button type="button" class="btn btn-primary" id="import-modal-import" style="display: none;">استيراد</button>
        </div>
    </div>
</div>

<!-- Barcode Generator Modal -->
<div id="barcode-modal" class="modal-overlay" style="display: none;">
    <div class="modal">
        <div class="modal-header">
            <h3 class="modal-title">توليد باركود</h3>
            <button class="modal-close" id="barcode-modal-close">&times;</button>
        </div>
        <div class="modal-body">
            <div class="barcode-generator">
                <div class="form-group">
                    <label for="barcode-text" class="form-label">نص الباركود</label>
                    <input type="text" id="barcode-text" class="form-control" placeholder="أدخل النص أو الرقم">
                </div>
                
                <div class="barcode-preview" id="barcode-preview">
                    <!-- Barcode will be generated here -->
                </div>
                
                <div class="barcode-actions">
                    <button class="btn btn-primary" id="generate-barcode-preview-btn">توليد الباركود</button>
                    <button class="btn btn-secondary" id="print-barcode-btn">طباعة</button>
                    <button class="btn btn-secondary" id="save-barcode-btn">حفظ</button>
                </div>
            </div>
        </div>
    </div>
</div>
